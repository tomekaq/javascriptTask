<html>

<head>
    <title> Generowanie losowych liczb</title>

    <style>
        p {
            /*color:cyan;*/
        }

        body {
            background-color: aliceblue;
            color-interpolation:linearRGB;
        }

        span {
            font-style: normal;
            color: palevioletred;
        }

        td {
            color: brown;
            font-style: normal;
        }

        #okButton, #reset {
            color: chocolate;
        }

        #genButton {
            color-interpolation:linearRGB;
        }
    </style>

    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <script>

        window.onload = function () {
            $("myButton").style.display = 'none';
        }

        function validate() {
            var fileNumber = parseInt($("#textbox1").val());
            var MaxValue = parseInt($("#textbox2").val());

            $("#war1").remove();
            $("#war2").remove();

            if ((fileNumber == 0 | isNaN(fileNumber)) & (MaxValue == 0 | isNaN(MaxValue))) {
                $('<td id="war1"> Wprowadz ile liczb wygenerować.</td>').appendTo('#myTable').appendTo('#col1');
                $('<td id="war2"> Wprowadz maksymalną wartość.</td>').appendTo('#myTable').appendTo('#col2');
            }
            else if (fileNumber == 0 | isNaN(fileNumber)) {
                $('<td id="war1">Wprowadz ile liczb wygenerować.</td>').appendTo('#myTable').appendTo('#col1');
            }
            else if (MaxValue == 0 | isNaN(MaxValue)) {
                $('<td id="war2"> Wprowadz maksymalną wartość.</td>').appendTo('#myTable').appendTo('#col2');
            }
            else if (MaxValue < 0) {
                $('<td id="war2"> "Maksymalna wartość musi być większa od zera.</td>').appendTo('#myTable').appendTo('#col2');
            }
            else if (MaxValue > 2147483647) {
                $('<td id="war2"> "Maksymalna wartość musi być mniejsza niż 2147483647." </td>').appendTo('#myTable').appendTo('#col2');
            }
            else {
                $("#okButton").attr("disabled", true);
                $("#textbox1").attr("disabled", true);
                $("#textbox2").attr("disabled", true);
                $('<input type="button" id="genButton" value= "Generuj"/>').appendTo('.genbutton');
            }
        }
        $(document).on('click', '#genButton', function () {
            var fileNumber = parseInt($("#textbox1").val());
            var MaxValue = parseInt($("#textbox2").val());
            var getUrl = '@Url.Action("Download","Home")';

            $.ajax({
                url: '/Home/GenerateFile',
                dataType: "json",
                type: "POST",
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify({ file: { FileAmount: fileNumber, MaxValue: MaxValue } }),
                async: true,
                processData: false,
                cache: false,
                success: function (data) {
                    if (data.success)
                        window.location = getUrl + "?fileName=" + data.fName;
                },
                error: function (xhr) {
                    alert('error');
                }
            });
        });

        function reset() {
            $("#war1").remove();
            $("#war2").remove();
            $("#okButton").attr("disabled", false);
            $("#textbox1").attr("disabled", false).val(0);
            $("#textbox2").attr("disabled", false).val(0);
            $('.genbutton').children().remove();
        }

    </script>

</head>

<body>

    <table id="myTable">
        <tr width="10%" id="col1">
            <td>Wprowadź ile liczb wygenerować:</td>
            <td>  <input type="text" size="20" id="textbox1" name="fileAmount" /></td>
        </tr>
        <tr width="10%" id="col2">
            <td>Wprowadź maksymalną wartość:</td>
            <td><input type="text" size="20" id="textbox2" name="maxValue" /> </td>
        </tr>
        <tr id="buttons">
            <td align="right">
                <input type="button" id="okButton" name="submit" value="OK" onclick="validate()" dis>
                <input type="button" id="reset" value="Resetuj" onclick="reset()" />
            </td>
            <td><div class="genbutton" /></td>
        </tr>
    </table>

</body>

</html>
